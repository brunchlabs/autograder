name: 'Autograder Action'
description: 'Automatically grades student submissions based on a report.'
inputs:
  report:
    description: 'The report generated by tests'
    required: true

runs:
  using: 'composite'
  steps:
    - name: Checkout code
      uses: actions/checkout@v3
      with:
        repository: brunchlabs/autograder

    - name: Set up Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '20'

    - name: Install dependencies
      shell: bash
      run: npm ci

    - name: Grade submission
      shell: bash
      run: node autograder.js
      env:
        REPOSITORY_NAME: ${{ github.event.repository.name }}
        STUDENT_ID: ${{ github.actor_id }}
        ORGANIZATION_ID: ${{ github.repository_owner_id }}
        BRANCH: ${{ github.ref_name }}
        REPORT: ${{ inputs.report }}
